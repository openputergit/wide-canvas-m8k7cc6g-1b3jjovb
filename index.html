<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatVibe - Modern Messaging Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: #f0f2f5;
        }
        .chat-container {
            max-height: calc(100vh - 250px);
            overflow-y: auto;
        }
        .message-bubble {
            max-width: 70%;
        }
        .typing-indicator {
            display: inline-flex;
            align-items: center;
            gap: 2px;
        }
        .typing-dot {
            width: 6px;
            height: 6px;
            background: #90cdf4;
            border-radius: 50%;
            animation: typing 1s infinite ease-in-out;
        }
        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-4px); }
        }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #c5c5c5;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a0a0a0;
        }
        
        /* Animation for profile page */
        @keyframes slideIn {
            0% { transform: translateX(100%); }
            100% { transform: translateX(0); }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out forwards;
        }
        
        /* Pulse animation for voice recording */
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body class="h-screen flex flex-col">
    <!-- Login Page -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center bg-gray-100">
        <div class="bg-white p-8 rounded-lg shadow-md w-96">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-blue-600">ChatVibe</h1>
                <p class="text-gray-600">Connect with people securely</p>
            </div>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Phone Number</label>
                    <input type="tel" id="phone" class="mt-1 block w-full rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2" placeholder="+1 123 456 7890" required>
                </div>
                <button type="submit" class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Get OTP
                </button>
            </form>
        </div>
    </div>

    <!-- OTP Verification Page -->
    <div id="otpPage" class="min-h-screen hidden flex items-center justify-center bg-gray-100">
        <div class="bg-white p-8 rounded-lg shadow-md w-96">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gray-900">Verify OTP</h2>
                <p id="otpPhoneDisplay" class="text-gray-600">Enter the code sent to your phone</p>
            </div>
            <form id="otpForm" class="space-y-4">
                <div class="flex justify-between gap-2">
                    <input type="text" maxlength="1" class="w-12 h-12 text-center border-2 rounded-lg" required>
                    <input type="text" maxlength="1" class="w-12 h-12 text-center border-2 rounded-lg" required>
                    <input type="text" maxlength="1" class="w-12 h-12 text-center border-2 rounded-lg" required>
                    <input type="text" maxlength="1" class="w-12 h-12 text-center border-2 rounded-lg" required>
                    <input type="text" maxlength="1" class="w-12 h-12 text-center border-2 rounded-lg" required>
                    <input type="text" maxlength="1" class="w-12 h-12 text-center border-2 rounded-lg" required>
                </div>
                <div class="text-center text-sm mt-2">
                    <span id="timer" class="text-gray-500">Resend OTP in: 01:00</span>
                </div>
                <button type="submit" class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                    Verify
                </button>
                <button type="button" id="backToLogin" class="w-full py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                    Back
                </button>
            </form>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-blue-600 text-white p-4">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-2xl font-bold">ChatVibe</h1>
                <div class="flex items-center space-x-4">
                    <button id="aiAssistBtn" class="hover:bg-blue-700 p-2 rounded">
                        <i class="bi bi-robot"></i>
                    </button>
                    <button id="healthBtn" class="hover:bg-blue-700 p-2 rounded">
                        <i class="bi bi-heart-pulse"></i>
                    </button>
                    <button id="profileBtn" class="hover:bg-blue-700 p-2 rounded">
                        <i class="bi bi-person-circle"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 flex overflow-hidden">
            <!-- Sidebar -->
            <div class="w-1/4 bg-white border-r">
                <div class="p-4">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search conversations..." class="w-full pl-10 pr-4 py-2 border rounded-lg">
                        <i class="bi bi-search absolute left-3 top-3 text-gray-400"></i>
                        <button id="voiceSearchBtn" class="absolute right-3 top-2 text-gray-400 hover:text-blue-600">
                            <i class="bi bi-mic"></i>
                        </button>
                    </div>
                </div>
                <div id="chatsList" class="overflow-y-auto h-[calc(100%-70px)]">
                    <!-- Chat list will be populated here -->
                </div>
            </div>

            <!-- Chat Area -->
            <div id="chatArea" class="flex-1 flex flex-col bg-gray-50">
                <!-- Empty state -->
                <div id="emptyChatState" class="flex-1 flex items-center justify-center flex-col p-4">
                    <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mb-4">
                        <i class="bi bi-chat-dots text-blue-500 text-4xl"></i>
                    </div>
                    <h3 class="text-xl font-medium text-gray-700">Start a conversation</h3>
                    <p class="text-gray-500 text-center max-w-md mt-2">Select a chat from the sidebar or start a new conversation to begin messaging.</p>
                </div>
                
                <!-- Active chat -->
                <div id="activeChatHeader" class="bg-white border-b p-3 hidden">
                    <div class="flex items-center space-x-3">
                        <button id="backToChats" class="md:hidden text-gray-600">
                            <i class="bi bi-arrow-left"></i>
                        </button>
                        <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="font-medium text-blue-800">JD</span>
                        </div>
                        <div class="flex-1">
                            <h3 id="contactName" class="font-medium">John Doe</h3>
                            <p class="text-xs text-gray-500" id="onlineStatus">Online</p>
                        </div>
                        <div class="flex space-x-2">
                            <button class="p-2 text-gray-600 hover:text-blue-600">
                                <i class="bi bi-telephone"></i>
                            </button>
                            <button class="p-2 text-gray-600 hover:text-blue-600">
                                <i class="bi bi-camera-video"></i>
                            </button>
                            <button class="p-2 text-gray-600 hover:text-blue-600">
                                <i class="bi bi-three-dots-vertical"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="messagesContainer" class="chat-container p-4 flex-1 hidden">
                    <!-- Messages will be populated here -->
                </div>
                
                <div id="chatInput" class="p-4 bg-white border-t hidden">
                    <div class="flex items-center space-x-2">
                        <button id="attachmentBtn" class="p-2 text-gray-600 hover:text-blue-600 relative">
                            <i class="bi bi-paperclip"></i>
                        </button>
                        <input id="messageInput" type="text" placeholder="Type a message..." class="flex-1 p-2 border rounded-lg">
                        <button id="voiceMessageBtn" class="p-2 text-gray-600 hover:text-blue-600">
                            <i class="bi bi-mic"></i>
                        </button>
                        <button id="sendMessageBtn" class="p-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700">
                            <i class="bi bi-send"></i>
                        </button>
                    </div>
                    
                    <!-- Attachment Popup Menu -->
                    <div id="attachmentMenu" class="hidden absolute bottom-16 left-4 bg-white shadow-lg rounded-lg p-2 w-60 z-10">
                        <div class="grid grid-cols-3 gap-2">
                            <button class="flex flex-col items-center p-2 hover:bg-gray-100 rounded">
                                <i class="bi bi-camera text-blue-500 text-xl"></i>
                                <span class="text-xs mt-1">Camera</span>
                            </button>
                            <button class="flex flex-col items-center p-2 hover:bg-gray-100 rounded">
                                <i class="bi bi-image text-green-500 text-xl"></i>
                                <span class="text-xs mt-1">Gallery</span>
                            </button>
                            <button class="flex flex-col items-center p-2 hover:bg-gray-100 rounded">
                                <i class="bi bi-file-earmark text-yellow-500 text-xl"></i>
                                <span class="text-xs mt-1">Document</span>
                            </button>
                            <button class="flex flex-col items-center p-2 hover:bg-gray-100 rounded">
                                <i class="bi bi-geo-alt text-red-500 text-xl"></i>
                                <span class="text-xs mt-1">Location</span>
                            </button>
                            <button class="flex flex-col items-center p-2 hover:bg-gray-100 rounded">
                                <i class="bi bi-person text-purple-500 text-xl"></i>
                                <span class="text-xs mt-1">Contact</span>
                            </button>
                            <button class="flex flex-col items-center p-2 hover:bg-gray-100 rounded">
                                <i class="bi bi-music-note text-pink-500 text-xl"></i>
                                <span class="text-xs mt-1">Audio</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Voice recording UI -->
                <div id="voiceRecordingUI" class="p-4 bg-white border-t hidden">
                    <div class="flex items-center justify-between">
                        <button id="cancelRecording" class="text-red-500">
                            <i class="bi bi-x-circle"></i>
                        </button>
                        <div class="flex flex-col items-center">
                            <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center pulse">
                                <i class="bi bi-mic-fill text-red-500 text-xl"></i>
                            </div>
                            <div class="text-sm text-gray-500 mt-1" id="recordingTime">00:00</div>
                        </div>
                        <button id="sendRecording" class="text-blue-600">
                            <i class="bi bi-send"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Profile Section (Hidden by default) -->
            <div id="profileSection" class="hidden absolute top-0 right-0 w-full md:w-1/3 h-full bg-white shadow-xl z-20">
                <div class="p-4 border-b flex justify-between items-center bg-blue-600 text-white">
                    <h2 class="text-xl font-semibold">Profile</h2>
                    <button id="closeProfile" class="p-2 hover:bg-blue-700 rounded">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div class="flex flex-col items-center mb-6">
                        <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mb-2 relative">
                            <span class="text-2xl font-semibold text-blue-800">JD</span>
                            <div class="absolute bottom-0 right-0 bg-blue-500 p-1 rounded-full cursor-pointer">
                                <i class="bi bi-pencil-fill text-white text-xs"></i>
                            </div>
                        </div>
                        <h3 class="text-xl font-semibold">John Doe</h3>
                        <p class="text-gray-500">+1 123 456 7890</p>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="border rounded-lg p-4">
                            <h4 class="font-medium mb-2 flex items-center">
                                <i class="bi bi-info-circle mr-2 text-blue-500"></i>
                                About
                            </h4>
                            <p class="text-gray-600">Hey there! I'm using ChatVibe</p>
                        </div>
                        
                        <div class="border rounded-lg divide-y">
                            <div class="p-4 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="bi bi-bell text-blue-500 mr-3"></i>
                                    <span>Notifications</span>
                                </div>
                                <i class="bi bi-chevron-right text-gray-400"></i>
                            </div>
                            <div class="p-4 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="bi bi-lock text-blue-500 mr-3"></i>
                                    <span>Privacy</span>
                                </div>
                                <i class="bi bi-chevron-right text-gray-400"></i>
                            </div>
                            <div class="p-4 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="bi bi-shield-check text-blue-500 mr-3"></i>
                                    <span>Security</span>
                                </div>
                                <i class="bi bi-chevron-right text-gray-400"></i>
                            </div>
                            <div class="p-4 flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="bi bi-palette text-blue-500 mr-3"></i>
                                    <span>Theme</span>
                                </div>
                                <i class="bi bi-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                        
                        <button id="logoutBtn" class="w-full py-2 px-4 flex items-center justify-center text-red-600 border border-red-200 rounded-lg hover:bg-red-50">
                            <i class="bi bi-box-arrow-right mr-2"></i>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Health Tracking Section (Hidden by default) -->
            <div id="healthSection" class="hidden absolute top-0 right-0 w-full md:w-1/3 h-full bg-white shadow-xl z-20">
                <div class="p-4 border-b flex justify-between items-center bg-blue-600 text-white">
                    <h2 class="text-xl font-semibold">Health & Wellness</h2>
                    <button id="closeHealth" class="p-2 hover:bg-blue-700 rounded">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
                <div class="p-6 overflow-y-auto h-full">
                    <div class="bg-blue-50 p-4 rounded-lg mb-6">
                        <h3 class="font-medium text-blue-800 mb-2">Today's Summary</h3>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="bg-white p-3 rounded-lg shadow-sm">
                                <div class="text-xl font-bold text-blue-600">7,342</div>
                                <div class="text-xs text-gray-500">Steps</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg shadow-sm">
                                <div class="text-xl font-bold text-green-600">6.5</div>
                                <div class="text-xs text-gray-500">Hours Sleep</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg shadow-sm">
                                <div class="text-xl font-bold text-purple-600">62</div>
                                <div class="text-xs text-gray-500">bpm</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="font-medium mb-3">Wellness Goals</h3>
                        <div class="space-y-3">
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-medium">Daily Steps</span>
                                    <span class="text-sm text-blue-600">7,342 / 10,000</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 73%"></div>
                                </div>
                            </div>
                            
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-medium">Water Intake</span>
                                    <span class="text-sm text-blue-600">5 / 8 glasses</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 62%"></div>
                                </div>
                            </div>
                            
                            <div class="bg-white p-3 rounded-lg border">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-medium">Meditation</span>
                                    <span class="text-sm text-blue-600">10 / 20 minutes</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 50%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h3 class="font-medium mb-3">Activity History</h3>
                        <div class="bg-white border rounded-lg overflow-hidden">
                            <div class="flex border-b">
                                <div class="w-1/3 p-3 font-medium text-center border-r">Day</div>
                                <div class="w-1/3 p-3 font-medium text-center border-r">Steps</div>
                                <div class="w-1/3 p-3 font-medium text-center">Sleep</div>
                            </div>
                            <div class="flex border-b">
                                <div class="w-1/3 p-3 text-center border-r text-sm">Mon</div>
                                <div class="w-1/3 p-3 text-center border-r text-sm">8,245</div>
                                <div class="w-1/3 p-3 text-center text-sm">7.2 hrs</div>
                            </div>
                            <div class="flex border-b">
                                <div class="w-1/3 p-3 text-center border-r text-sm">Tue</div>
                                <div class="w-1/3 p-3 text-center border-r text-sm">9,321</div>
                                <div class="w-1/3 p-3 text-center text-sm">6.8 hrs</div>
                            </div>
                            <div class="flex">
                                <div class="w-1/3 p-3 text-center border-r text-sm">Wed</div>
                                <div class="w-1/3 p-3 text-center border-r text-sm">7,342</div>
                                <div class="w-1/3 p-3 text-center text-sm">6.5 hrs</div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        Connect Health Services
                    </button>
                </div>
            </div>
            
            <!-- AI Assistant (Hidden by default) -->
            <div id="aiAssistant" class="hidden absolute top-0 right-0 w-full md:w-1/3 h-full bg-white shadow-xl z-20">
                <div class="p-4 border-b flex justify-between items-center bg-blue-600 text-white">
                    <h2 class="text-xl font-semibold">AI Assistant</h2>
                    <button id="closeAI" class="p-2 hover:bg-blue-700 rounded">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
                <div class="flex flex-col h-[calc(100%-64px)]">
                    <div id="aiMessages" class="flex-1 p-4 overflow-y-auto">
                        <div class="flex flex-col space-y-4">
                            <div class="flex items-start">
                                <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-2">
                                    <i class="bi bi-robot text-blue-600"></i>
                                </div>
                                <div class="bg-blue-50 p-3 rounded-lg max-w-[80%]">
                                    <p class="text-gray-800">Hello! I'm your AI assistant. How can I help you today?</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-4 border-t">
                        <div class="flex items-center space-x-2">
                            <input id="aiInput" type="text" placeholder="Ask anything..." class="flex-1 p-2 border rounded-lg">
                            <button id="aiSendBtn" class="p-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700">
                                <i class="bi bi-send"></i>
                            </button>
                        </div>
                        <div class="mt-2 flex flex-wrap gap-2">
                            <button class="bg-gray-100 px-3 py-1 rounded-full text-sm text-gray-600 hover:bg-gray-200">
                                Summarize chat
                            </button>
                            <button class="bg-gray-100 px-3 py-1 rounded-full text-sm text-gray-600 hover:bg-gray-200">
                                Health tips
                            </button>
                            <button class="bg-gray-100 px-3 py-1 rounded-full text-sm text-gray-600 hover:bg-gray-200">
                                Translate message
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const otpPage = document.getElementById('otpPage');
        const mainApp = document.getElementById('mainApp');
        const profileSection = document.getElementById('profileSection');
        const healthSection = document.getElementById('healthSection');
        const aiAssistant = document.getElementById('aiAssistant');
        const chatsList = document.getElementById('chatsList');
        const emptyChatState = document.getElementById('emptyChatState');
        const activeChatHeader = document.getElementById('activeChatHeader');
        const messagesContainer = document.getElementById('messagesContainer');
        const chatInput = document.getElementById('chatInput');
        const attachmentMenu = document.getElementById('attachmentMenu');
        const voiceRecordingUI = document.getElementById('voiceRecordingUI');

        // Sample data for chats
        const chatData = [
            { 
                id: 1, 
                name: 'John Doe', 
                lastMessage: 'Hey, how are you?', 
                time: '10:30 AM', 
                unread: 2, 
                avatar: 'JD', 
                avatarColor: 'bg-blue-100',
                isOnline: true 
            },
            { 
                id: 2, 
                name: 'Jane Smith', 
                lastMessage: 'Meeting at 2 PM', 
                time: '9:45 AM', 
                unread: 0, 
                avatar: 'JS', 
                avatarColor: 'bg-green-100',
                isOnline: true 
            },
            { 
                id: 3, 
                name: 'Mike Johnson', 
                lastMessage: 'Please send the files', 
                time: 'Yesterday', 
                unread: 0, 
                avatar: 'MJ', 
                avatarColor: 'bg-purple-100',
                isOnline: false 
            },
            { 
                id: 4, 
                name: 'Sarah Wilson', 
                lastMessage: 'Great! See you then', 
                time: 'Yesterday', 
                unread: 1, 
                avatar: 'SW', 
                avatarColor: 'bg-yellow-100',
                isOnline: false 
            },
            { 
                id: 5, 
                name: 'Tech Support', 
                lastMessage: 'How can I help you?', 
                time: 'Wed', 
                unread: 0, 
                avatar: 'TS', 
                avatarColor: 'bg-red-100',
                isOnline: true 
            }
        ];
        
        // Sample messages data
        const messagesData = {
            1: [
                { sender: 'other', text: 'Hey there! How are you doing?', time: '10:20 AM' },
                { sender: 'self', text: 'I\'m good, thanks! Just working on a project.', time: '10:25 AM' },
                { sender: 'other', text: 'Nice! What kind of project?', time: '10:28 AM' },
                { sender: 'self', text: 'It\'s a messaging app, similar to this one actually!', time: '10:30 AM' }
            ],
            2: [
                { sender: 'self', text: 'Hi Jane, are we still on for the meeting today?', time: '9:30 AM' },
                { sender: 'other', text: 'Yes! Meeting at 2 PM in the conference room.', time: '9:35 AM' },
                { sender: 'other', text: 'Don\'t forget to bring your presentation.', time: '9:36 AM' },
                { sender: 'self', text: 'Got it, thanks for the reminder!', time: '9:45 AM' }
            ]
        };
        
        // AI conversation sample
        const aiMessages = [
            { sender: 'ai', text: 'Hello! I\'m your AI assistant. How can I help you today?' }
        ];
        
        // Initialize chat list
        function renderChatList() {
            chatsList.innerHTML = '';
            chatData.forEach(chat => {
                const chatElement = document.createElement('div');
                chatElement.className = 'flex items-center px-4 py-3 border-b hover:bg-gray-50 cursor-pointer';
                chatElement.dataset.chatId = chat.id;
                
                chatElement.innerHTML = `
                    <div class="relative mr-3">
                        <div class="w-12 h-12 ${chat.avatarColor} rounded-full flex items-center justify-center">
                            <span class="font-medium text-gray-800">${chat.avatar}</span>
                        </div>
                        ${chat.isOnline ? '<span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></span>' : ''}
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between">
                            <h4 class="font-medium">${chat.name}</h4>
                            <span class="text-xs text-gray-500">${chat.time}</span>
                        </div>
                        <div class="flex justify-between">
                            <p class="text-sm text-gray-600 truncate pr-2">${chat.lastMessage}</p>
                            ${chat.unread > 0 ? `<span class="bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">${chat.unread}</span>` : ''}
                        </div>
                    </div>
                `;
                
                chatElement.addEventListener('click', () => openChat(chat.id));
                chatsList.appendChild(chatElement);
            });
        }
        
        // Open chat
        function openChat(chatId) {
            // Update header with contact info
            const chat = chatData.find(c => c.id === chatId);
            document.getElementById('contactName').textContent = chat.name;
            document.getElementById('onlineStatus').textContent = chat.isOnline ? 'Online' : 'Offline';
            
            // Show chat interface
            emptyChatState.classList.add('hidden');
            activeChatHeader.classList.remove('hidden');
            messagesContainer.classList.remove('hidden');
            chatInput.classList.remove('hidden');
            
            // Clear old messages
            messagesContainer.innerHTML = '';
            
            // Add messages if available
            if (messagesData[chatId]) {
                messagesData[chatId].forEach(message => {
                    const messageElement = document.createElement('div');
                    messageElement.className = `flex ${message.sender === 'self' ? 'justify-end' : 'justify-start'} mb-4`;
                    
                    messageElement.innerHTML = `
                        <div class="${message.sender === 'self' ? 'bg-blue-500 text-white' : 'bg-gray-200'} rounded-lg p-3 message-bubble">
                            <p>${message.text}</p>
                            <div class="text-xs ${message.sender === 'self' ? 'text-blue-100' : 'text-gray-500'} text-right mt-1">${message.time}</div>
                        </div>
                    `;
                    
                    messagesContainer.appendChild(messageElement);
                });
                
                // Update seen status by removing unread count
                const chatIndex = chatData.findIndex(c => c.id === chatId);
                if (chatIndex !== -1) {
                    chatData[chatIndex].unread = 0;
                    renderChatList();
                }
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            // Mobile responsive: hide sidebar on small screens
            if (window.innerWidth < 768) {
                document.querySelector('.w-1/4').classList.add('hidden');
            }
        }
        
        // Send message
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (message) {
                // Find active chat
                const activeChatName = document.getElementById('contactName').textContent;
                const chatId = chatData.find(c => c.name === activeChatName).id;
                
                // Create message element
                const messageElement = document.createElement('div');
                messageElement.className = 'flex justify-end mb-4';
                
                const currentTime = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                messageElement.innerHTML = `
                    <div class="bg-blue-500 text-white rounded-lg p-3 message-bubble">
                        <p>${message}</p>
                        <div class="text-xs text-blue-100 text-right mt-1">${currentTime}</div>
                    </div>
                `;
                
                messagesContainer.appendChild(messageElement);
                
                // Clear input
                messageInput.value = '';
                
                // Update last message in chat list
                const chatIndex = chatData.findIndex(c => c.id === chatId);
                if (chatIndex !== -1) {
                    chatData[chatIndex].lastMessage = message;
                    chatData[chatIndex].time = 'Just now';
                    renderChatList();
                }
                
                // Save to messages data
                if (!messagesData[chatId]) {
                    messagesData[chatId] = [];
                }
                messagesData[chatId].push({ sender: 'self', text: message, time: currentTime });
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
                // Simulate reply if this is John's chat
                if (chatId === 1) {
                    simulateTyping();
                    setTimeout(() => {
                        simulateReply(chatId);
                    }, 2000);
                }
            }
        }
        
        // Simulate typing indicator
        function simulateTyping() {
            const typingElement = document.createElement('div');
            typingElement.className = 'flex justify-start mb-4';
            typingElement.id = 'typingIndicator';
            
            typingElement.innerHTML = `
                <div class="bg-gray-200 rounded-lg p-3 message-bubble">
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(typingElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        // Simulate reply
        function simulateReply(chatId) {
            // Remove typing indicator
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
            
            const replies = [
                "That's great! Keep up the good work.",
                "How's the progress going so far?",
                "Sounds interesting! Tell me more about it.",
                "Do you need any help with that?",
                "I'd love to see it when it's done!"
            ];
            
            const randomReply = replies[Math.floor(Math.random() * replies.length)];
            const currentTime = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            // Create message element
            const messageElement = document.createElement('div');
            messageElement.className = 'flex justify-start mb-4';
            
            messageElement.innerHTML = `
                <div class="bg-gray-200 rounded-lg p-3 message-bubble">
                    <p>${randomReply}</p>
                    <div class="text-xs text-gray-500 text-right mt-1">${currentTime}</div>
                </div>
            `;
            
            messagesContainer.appendChild(messageElement);
            
            // Update last message in chat list
            const chatIndex = chatData.findIndex(c => c.id === chatId);
            if (chatIndex !== -1) {
                chatData[chatIndex].lastMessage = randomReply;
                chatData[chatIndex].time = 'Just now';
                renderChatList();
            }
            
            // Save to messages data
            if (!messagesData[chatId]) {
                messagesData[chatId] = [];
            }
            messagesData[chatId].push({ sender: 'other', text: randomReply, time: currentTime });
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        // Send AI message
        function sendAiMessage() {
            const aiInput = document.getElementById('aiInput');
            const message = aiInput.value.trim();
            const aiMessagesContainer = document.getElementById('aiMessages');
            
            if (message) {
                // Add user message
                const messageElement = document.createElement('div');
                messageElement.className = 'flex items-start justify-end mb-4';
                messageElement.innerHTML = `
                    <div class="bg-blue-500 text-white p-3 rounded-lg max-w-[80%]">
                        <p>${message}</p>
                    </div>
                `;
                aiMessagesContainer.appendChild(messageElement);
                
                // Store message
                aiMessages.push({ sender: 'user', text: message });
                
                // Clear input
                aiInput.value = '';
                
                // Simulate AI typing
                const typingElement = document.createElement('div');
                typingElement.className = 'flex items-start mb-4';
                typingElement.id = 'aiTypingIndicator';
                
                typingElement.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-2">
                        <i class="bi bi-robot text-blue-600"></i>
                    </div>
                    <div class="bg-blue-50 p-3 rounded-lg max-w-[80%]">
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                `;
                
                aiMessagesContainer.appendChild(typingElement);
                aiMessagesContainer.scrollTop = aiMessagesContainer.scrollHeight;
                
                // Simulate AI response
                setTimeout(() => {
                    // Remove typing indicator
                    const typingIndicator = document.getElementById('aiTypingIndicator');
                    if (typingIndicator) {
                        typingIndicator.remove();
                    }
                    
                    // Generate response based on user message
                    let response = "";
                    if (message.toLowerCase().includes("hello") || message.toLowerCase().includes("hi")) {
                        response = "Hi there! How can I help you today?";
                    } else if (message.toLowerCase().includes("health") || message.toLowerCase().includes("wellness")) {
                        response = "I can provide health tips and track your wellness goals. Would you like some advice on improving your daily activity or sleep?";
                    } else if (message.toLowerCase().includes("time") || message.toLowerCase().includes("date")) {
                        const now = new Date();
                        response = `The current time is ${now.toLocaleTimeString()} on ${now.toLocaleDateString()}.`;
                    } else if (message.toLowerCase().includes("help")) {
                        response = "I can help you with messaging, health tracking, scheduling, and more. Just tell me what you need!";
                    } else {
                        response = "I understand you're interested in that. How can I assist you further with this topic?";
                    }
                    
                    // Add AI response
                    const responseElement = document.createElement('div');
                    responseElement.className = 'flex items-start mb-4';
                    responseElement.innerHTML = `
                        <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-2">
                            <i class="bi bi-robot text-blue-600"></i>
                        </div>
                        <div class="bg-blue-50 p-3 rounded-lg max-w-[80%]">
                            <p class="text-gray-800">${response}</p>
                        </div>
                    `;
                    
                    aiMessagesContainer.appendChild(responseElement);
                    aiMessagesContainer.scrollTop = aiMessagesContainer.scrollHeight;
                    
                    // Store AI response
                    aiMessages.push({ sender: 'ai', text: response });
                }, 1500);
            }
        }
        
        // OTP Timer
        function startOtpTimer() {
            const timerElement = document.getElementById('timer');
            let seconds = 60;
            
            const interval = setInterval(() => {
                seconds--;
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                timerElement.textContent = `Resend OTP in: ${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
                
                if (seconds <= 0) {
                    clearInterval(interval);
                    timerElement.textContent = 'Resend OTP';
                    timerElement.classList.remove('text-gray-500');
                    timerElement.classList.add('text-blue-600', 'cursor-pointer');
                    timerElement.addEventListener('click', () => {
                        timerElement.textContent = 'OTP resent!';
                        setTimeout(() => startOtpTimer(), 1000);
                    });
                }
            }, 1000);
        }
        
        // Recording time counter
        function startRecordingTimer() {
            const timerElement = document.getElementById('recordingTime');
            let seconds = 0;
            
            const interval = setInterval(() => {
                seconds++;
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
                
                // Auto-stop after 5 minutes
                if (seconds >= 300) {
                    clearInterval(interval);
                    stopRecording();
                }
            }, 1000);
            
            // Store interval ID to clear it later
            timerElement.dataset.intervalId = interval;
        }
        
        function stopRecording() {
            const timerElement = document.getElementById('recordingTime');
            clearInterval(timerElement.dataset.intervalId);
            voiceRecordingUI.classList.add('hidden');
            chatInput.classList.remove('hidden');
        }
        
        // Voice Search functionality
        function voiceSearch() {
            const searchInput = document.getElementById('searchInput');
            
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                
                recognition.onstart = () => {
                    const voiceSearchBtn = document.getElementById('voiceSearchBtn');
                    voiceSearchBtn.innerHTML = '<i class="bi bi-mic-fill text-red-500 pulse"></i>';
                };
                
                recognition.onresult = (event) => {
                    searchInput.value = event.results[0][0].transcript;
                    filterChats(searchInput.value.toLowerCase());
                };
                
                recognition.onend = () => {
                    const voiceSearchBtn = document.getElementById('voiceSearchBtn');
                    voiceSearchBtn.innerHTML = '<i class="bi bi-mic"></i>';
                };
                
                recognition.start();
            } else {
                alert('Voice recognition is not supported in your browser.');
            }
        }
        
        // Filter chats based on search input
        function filterChats(searchText) {
            const chatElements = document.querySelectorAll('#chatsList > div');
            
            chatElements.forEach(element => {
                const chatName = element.querySelector('h4').textContent.toLowerCase();
                const lastMessage = element.querySelector('p').textContent.toLowerCase();
                
                if (chatName.includes(searchText) || lastMessage.includes(searchText)) {
                    element.style.display = 'flex';
                } else {
                    element.style.display = 'none';
                }
            });
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize chat list
            renderChatList();
            
            // Login Form
            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const phone = document.getElementById('phone').value;
                
                if (phone) {
                    loginPage.classList.add('hidden');
                    otpPage.classList.remove('hidden');
                    document.getElementById('otpPhoneDisplay').textContent = `Enter the code sent to ${phone}`;
                    
                    // Start OTP timer
                    startOtpTimer();
                    
                    // Focus on first OTP input field
                    document.querySelector('#otpForm input:first-child').focus();
                }
            });
            
            // Back to Login
            document.getElementById('backToLogin').addEventListener('click', () => {
                otpPage.classList.add('hidden');
                loginPage.classList.remove('hidden');
            });
            
            // OTP Form
            const otpInputs = document.querySelectorAll('#otpForm input');
            otpInputs.forEach((input, index) => {
                input.addEventListener('input', (e) => {
                    if (e.target.value && index < otpInputs.length - 1) {
                        otpInputs[index + 1].focus();
                    }
                    
                    // Auto-submit when all fields are filled
                    const allFilled = Array.from(otpInputs).every(input => input.value);
                    if (allFilled) {
                        setTimeout(() => {
                            document.getElementById('otpForm').dispatchEvent(new Event('submit'));
                        }, 500);
                    }
                });
                
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Backspace' && !e.target.value && index > 0) {
                        otpInputs[index - 1].focus();
                    }
                });
                
                // Allow only numbers
                input.addEventListener('keypress', function(e) {
                    if (isNaN(parseInt(e.key))) {
                        e.preventDefault();
                    }
                });
            });
            
            document.getElementById('otpForm').addEventListener('submit', (e) => {
                e.preventDefault();
                otpPage.classList.add('hidden');
                mainApp.classList.remove('hidden');
            });
            
            // Profile button
            document.getElementById('profileBtn').addEventListener('click', () => {
                profileSection.classList.remove('hidden');
                profileSection.classList.add('slide-in');
                healthSection.classList.add('hidden');
                aiAssistant.classList.add('hidden');
            });
            
            document.getElementById('closeProfile').addEventListener('click', () => {
                profileSection.classList.add('hidden');
            });
            
            // Health button
            document.getElementById('healthBtn').addEventListener('click', () => {
                healthSection.classList.remove('hidden');
                healthSection.classList.add('slide-in');
                profileSection.classList.add('hidden');
                aiAssistant.classList.add('hidden');
            });
            
            document.getElementById('closeHealth').addEventListener('click', () => {
                healthSection.classList.add('hidden');
            });
            
            // AI Assistant button
            document.getElementById('aiAssistBtn').addEventListener('click', () => {
                aiAssistant.classList.remove('hidden');
                aiAssistant.classList.add('slide-in');
                profileSection.classList.add('hidden');
                healthSection.classList.add('hidden');
            });
            
            document.getElementById('closeAI').addEventListener('click', () => {
                aiAssistant.classList.add('hidden');
            });
            
            // Logout button
            document.getElementById('logoutBtn').addEventListener('click', () => {
                mainApp.classList.add('hidden');
                profileSection.classList.add('hidden');
                loginPage.classList.remove('hidden');
                // Reset form fields
                document.getElementById('phone').value = '';
            });
            
            // Back to chats (for mobile)
            document.getElementById('backToChats').addEventListener('click', () => {
                emptyChatState.classList.remove('hidden');
                activeChatHeader.classList.add('hidden');
                messagesContainer.classList.add('hidden');
                chatInput.classList.add('hidden');
                
                if (window.innerWidth < 768) {
                    document.querySelector('.w-1/4').classList.remove('hidden');
                }
            });
            
            // Send message
            document.getElementById('sendMessageBtn').addEventListener('click', sendMessage);
            
            // Send message on Enter press
            document.getElementById('messageInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Voice message button
            document.getElementById('voiceMessageBtn').addEventListener('click', () => {
                chatInput.classList.add('hidden');
                voiceRecordingUI.classList.remove('hidden');
                startRecordingTimer();
            });
            
            // Cancel recording
            document.getElementById('cancelRecording').addEventListener('click', stopRecording);
            
            // Send recording
            document.getElementById('sendRecording').addEventListener('click', () => {
                stopRecording();
                // Simulate sending audio message
                const messageElement = document.createElement('div');
                messageElement.className = 'flex justify-end mb-4';
                
                const currentTime = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                messageElement.innerHTML = `
                    <div class="bg-blue-500 text-white rounded-lg p-3 message-bubble">
                        <div class="flex items-center">
                            <i class="bi bi-file-earmark-music mr-2"></i>
                            <span>Voice message</span>
                        </div>
                        <div class="text-xs text-blue-100 text-right mt-1">${currentTime}</div>
                    </div>
                `;
                
                messagesContainer.appendChild(messageElement);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            });
            
            // Attachment button
            document.getElementById('attachmentBtn').addEventListener('click', () => {
                attachmentMenu.classList.toggle('hidden');
            });
            
            // Close attachment menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('#attachmentBtn') && !e.target.closest('#attachmentMenu')) {
                    attachmentMenu.classList.add('hidden');
                }
            });
            
            // Voice search button
            document.getElementById('voiceSearchBtn').addEventListener('click', voiceSearch);
            
            // Search input
            document.getElementById('searchInput').addEventListener('input', (e) => {
                filterChats(e.target.value.toLowerCase());
            });
            
            // AI Input
            document.getElementById('aiSendBtn').addEventListener('click', sendAiMessage);
            
            // Send AI message on Enter press
            document.getElementById('aiInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendAiMessage();
                }
            });
        });
    </script>
<script>document.body.addEventListener('wheel', e => { if (!e.ctrlKey) return; e.preventDefault(); return }, { passive: false })</script>
	</body>
</html>